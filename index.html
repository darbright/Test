<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏ß‡∏¢‡∏≠‡∏µ‡πÄ‡∏°‡∏•</title>
  <style>
    body {
      font-family: sans-serif;
      max-width: 600px;
      margin: 2em auto;
      padding: 1em;
    }
    input, button {
      padding: 8px;
      font-size: 16px;
    }
    input {
      width: 70%;
    }
    button {
      margin-left: 8px;
    }
    .result-box {
      margin-top: 20px;
      border-top: 1px solid #ccc;
      padding-top: 10px;
    }
    .status-danger {
      color: red;
      font-weight: bold;
    }
    .status-warning {
      color: orange;
      font-weight: bold;
    }
    .status-good {
      color: green;
      font-weight: bold;
    }
    #mediaContainer {
      margin-top: 20px;
      text-align: center;
    }
    #mediaContainer img, #mediaContainer video {
      max-width: 100%;
      height: auto;
    }
  </style>

</head>
<body>
  <h2>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏ß‡∏¢‡∏≠‡∏µ‡πÄ‡∏°‡∏•</h2>
  <input type="text" id="emailInput" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•">
  <button onclick="searchData()">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>

  <!-- ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÅ‡∏ó‡∏£‡∏Å‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
  <div id="result" class="result-box"></div>

  <!-- ‡∏™‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡πÅ‡∏£‡∏Å -->
  <div id="mediaContainer">
    <!-- ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û -->
    <img src="https://via.placeholder.com/500x300?text=‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û+‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì" alt="‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û">

    <!-- ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏∞‡πÉ‡∏™‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ -->
    <!--
    <video controls>
      <source src="your-video.mp4" type="video/mp4">
      ‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏ô‡∏µ‡πâ
    </video>
    -->
  </div>

  <script>
    function searchData() {
      const email = document.getElementById("emailInput").value.trim().toLowerCase();
      const resultBox = document.getElementById("result");
      if (!email) {
        resultBox.innerHTML = "<p style='color:red'>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•</p>";
        return;
      }

      resultBox.innerHTML = "üîç ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤...";

      fetch("https://script.google.com/macros/s/AKfycbyv.../exec?email=" + encodeURIComponent(email))
        .then(response => response.json())
        .then(data => {
          if (data.results && data.results.length > 0) {
            const rows = data.results.map(row => {
              let statusClass = "";
              if (row.status === "‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏") statusClass = "status-danger";
              else if (/‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏/.test(row.status)) statusClass = "status-warning";
              else statusClass = "status-good";

              return `
                <div>
                  <p><strong>Email:</strong> ${row.email}</p>
                  <p><strong>Entry Date:</strong> ${formatDate(row["entry date"])}</p>
                  <p><strong>Expiry Date:</strong> ${formatDate(row["expiry date"])}</p>
                  <p><strong>Status:</strong> <span class="${statusClass}">${row.status}</span></p>
                  <hr/>
                </div>`;
            }).join("");

            resultBox.innerHTML = rows;
          } else {
            resultBox.innerHTML = "<p style='color:red'>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>";
          }
        })
        .catch(err => {
          resultBox.innerHTML = "<p style='color:red'>‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>";
        });
    }

    function formatDate(dateStr) {
      const d = new Date(dateStr);
      return d.toLocaleDateString("th-TH", {
        year: "numeric", month: "long", day: "numeric"
      });
    }
  </script>
</body>
</html>

